# XTrack-xml-to-mdd

ManageLists.py was designed to simplify lists creation using information stored in an XML exported from XTrack.
Script functionalities:
- validates the XML input for required nodes and attributes
- validates if the list names and category codes to be inputed follow the dimenssions naming convention
- validates that all the languages present in the XML are available in the input MDD and stops the execution if there is a missing language.
- validates that all the languages present in the MDD are available in the input XML and prints a warning if there is a missing language
- creates in the metadata the lists from the XML and adds translations for the presented languages
- updates QTYPE, WAVE_NAME, WAVE_IDENTIFIER, wave variables metadata and routing based on the values presented in the input XML
- updates EXPLANATION_INSERT variable metadata based on the values presented in the input XML.
- creates routing (filters) based on the information from the mapping, attributes and mapping-groups nodes

## METADATA 

- Variables QTYPE, WAVE_NAME, WAVE_IDENTIFIER, wave and EXPLANATION_INSERT must be defined in the metadata (in the respective format).
Example:

    ```vb
        QTYPE "Type of Product"
        categorical [1..1]
        {
            _1 "BVC Express Full BVC",
            _2 "BVC Express AE",
            _3 "NON BVC Express"
        };

        WAVE_NAME "wave1 - (Version: 3 Final)"
            [
                IIS_IncludeOEinCEExport = true
            ]
        text [1..4000];

        WAVE_IDENTIFIER "61a64e24f4ba08000103ce81"
            [
                IIS_IncludeOEinCEExport = true
            ]
        text [1..24];

        Wave "3"
            [
                IIS_StandardShellTranslated = 1,
                IIS_CoreQuestionDescription = "Sample-Core-Questions",
                IIS_ExcludeFromDataExport = false,
                IIS_IncludeOEinCEExport = true
            ]
        text [0..3];  

        EXPLANATION_INSERT ""
            [
                IIS_ExcludeFromDataExport = false
            ]
        categorical [1..1]
        {
            _1 "brands offering high-quality clothing and accessories."
        };
    ```

- Lists BRANDLIST_TEXT_ONLY, BRANDLIST_LOGOS_LBT, BRANDLIST_LOGOS, BRANDLIST_CLOSENESS are the predefined names that will be used for the cration of the brand lists. Those lists will be automatically created/update on each execution. 
!Note: There should not be other lists containing "BRANDLIST" in their name

- CATEGORIES_LIST will be automatically created/update on each execution

---
## ROUTING

- Multiple filteres are automatically applied in the routing. In order to have those implemented you should place the below placeholder in the routing:
    ```vb
   '*** Start--List--Filters ***

   '*** End--List--Filters ***
    ```
!Note: All the filters created are custom dims, which should be assigned as specific filter to the respective variables manually.

The filters include:
* list items filter based on country and category
* statements filters based on touchpoints
* custom attribute/value pair filters

- Make sure you do not have "ibrand" dim in the routing as well as any "brandX" (where X is a number) dims, as those will be generated by the automation.

---
## Languages
-   If there are more language in XML than in MDD, an error is displayed and the execution is interrupted.
-   If there is additional language in MDD (not included in XML) that is not en-GB, a message is displayed and the script will be baused until you press a random key.
-   If there is additional language in MDD (not included in XML) that is en-GB, the script will continue and labels will be included in the predefined lists for en-GB.
---

## Wave variable
```xml
<wave>
    <name>The label given by the user in XTrack</name>
    <identifier>jn4ch-i385k-lom8-14hdn</identifier>
    <value>8</value>
</wave>

```
- name: The Xtrack wave name will be left up to the researcher to define
- identifier: This is Xtrack’s GUID. Just a value to store in the MDD.  As we move down the road, this will allow us to know what wave data should be associated to.
    > **_NOTE:_**  <font color="cyan" >To be used in naming the delivery zip archive?</font>
- value:&nbsp;&nbsp; <font color="red" ><b>Not used?</b></font>
- position: Not needed for SW/DP
---
## Type of Product variable (for BVC Express)

```xml
<qtype>1</qtype>
```
Based on the above value we will set a standard Type question in the routing (in case the tag is part of the xml)
